{"version":3,"file":"mobile.js","sources":["src/mobile.js"],"sourcesContent":["import {Loc} from 'main.core';\n\nlet nodeEnum = (function ()\n{\n\tlet nodeEnum = function (select, eventNode, container)\n\t{\n\t\tthis.click = BX.delegate(this.click, this);\n\t\tthis.callback = BX.delegate(this.callback, this);\n\t\tthis.multiple = false;\n\t\tthis.select = null;\n\t\tthis.eventNode = null;\n\t\tthis.container = null;\n\t\tthis.titles = [];\n\t\tthis.values = [];\n\t\tthis.defaultTitles = [];\n\t\tthis.init(select, eventNode, container);\n\t};\n\tnodeEnum.prototype = {\n\t\tinit: function (select, eventNode, container)\n\t\t{\n\t\t\tif (BX(select) && BX(eventNode) && BX(container))\n\t\t\t{\n\t\t\t\tthis.select = select;\n\t\t\t\tthis.eventNode = eventNode;\n\t\t\t\tthis.container = container;\n\n\t\t\t\tif (!this.select.hasAttribute('bx-bound'))\n\t\t\t\t{\n\t\t\t\t\tthis.select.setAttribute('bx-bound', 'Y');\n\t\t\t\t\tBX.addCustomEvent(select, 'onChange', BX.delegate(function ()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.multiple = this.select.hasAttribute('multiple');\n\t\t\t\t\t\tthis.initValues();\n\t\t\t\t\t}, this));\n\t\t\t\t\tBX.bind(this.eventNode, 'click', this.click);\n\t\t\t\t}\n\t\t\t\tthis.multiple = select.hasAttribute('multiple');\n\t\t\t\tthis.initValues();\n\t\t\t}\n\t\t},\n\t\tinitValues: function ()\n\t\t{\n\t\t\tthis.titles = [];\n\t\t\tthis.values = [];\n\t\t\tthis.defaultTitles = [];\n\t\t\tfor (let ii = 0; ii < this.select.options.length; ii++)\n\t\t\t{\n\t\t\t\tthis.titles.push(this.select.options[ii].innerHTML);\n\t\t\t\tthis.values.push(this.select.options[ii].value);\n\t\t\t\tif (this.select.options[ii].hasAttribute('selected'))\n\t\t\t\t{\n\t\t\t\t\tthis.defaultTitles.push(this.select.options[ii].innerHTML);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tclick: function (e)\n\t\t{\n\t\t\tthis.show();\n\t\t\treturn BX.PreventDefault(e);\n\t\t},\n\t\tshow: function ()\n\t\t{\n\t\t\tif (this.titles.length > 0)\n\t\t\t{\n\t\t\t\tBXMobileApp.UI.SelectPicker.show({\n\t\t\t\t\tcallback: this.callback,\n\t\t\t\t\tvalues: this.titles,\n\t\t\t\t\tmultiselect: this.multiple,\n\t\t\t\t\tdefault_value: this.defaultTitles\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tcallback: function (data)\n\t\t{\n\t\t\tthis.defaultTitles = [];\n\t\t\tif (data && data.values && data.values.length > 0)\n\t\t\t{\n\t\t\t\tlet keys = [];\n\t\t\t\tfor (let ii = 0; ii < this.titles.length; ii++)\n\t\t\t\t{\n\t\t\t\t\tfor (let jj = 0; jj < data.values.length; jj++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.titles[ii] === data.values[jj])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tkeys.push(this.values[ii]);\n\t\t\t\t\t\t\tthis.defaultTitles.push(this.titles[ii]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlet html = '';\n\t\t\t\tfor (let ii = 0; ii < this.select.options.length; ii++)\n\t\t\t\t{\n\t\t\t\t\tthis.select.options[ii].removeAttribute('selected');\n\t\t\t\t\tif (BX.util.in_array(this.select.options[ii].value, keys))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.select.options[ii].setAttribute('selected', 'selected');\n\t\t\t\t\t\tif (this.multiple)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml += this.select.options[ii].innerHTML + '<br>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml = this.select.options[ii].innerHTML;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (html === '' && !this.multiple)\n\t\t\t\t{\n\t\t\t\t\thtml = `<span style=\"color:grey\">${Loc.getMessage('interface_form_select')}</span>`;\n\t\t\t\t}\n\t\t\t\tthis.container.innerHTML = html;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (let ii = 0; ii < this.select.options.length; ii++)\n\t\t\t\t{\n\t\t\t\t\tthis.select.options[ii].removeAttribute('selected');\n\t\t\t\t}\n\t\t\t\tthis.container.innerHTML = '';\n\t\t\t}\n\n\t\t\tBX.onCustomEvent(this, 'onChange', [this, this.select]);\n\t\t}\n\t};\n\treturn nodeEnum;\n})();\nwindow.app.exec('enableCaptureKeyboard', true);\n\nBX.Mobile.Field.Enum = function (params)\n{\n\tthis.init(params);\n};\nBX.Mobile.Field.Enum.prototype = {\n\t__proto__: BX.Mobile.Field.prototype,\n\tbindElement: function (node)\n\t{\n\t\tlet result = null;\n\t\tif (BX(node))\n\t\t{\n\t\t\t// let type = (\n\t\t\t// \tnode.hasAttribute('data-bx-type') ?\n\t\t\t// \t\tnode.getAttribute('data-bx-type').toLowerCase() : ''\n\t\t\t// );\n\t\t\tresult = new nodeEnum(\n\t\t\t\tnode,\n\t\t\t\tBX(`${node.id}_select`),\n\t\t\t\tBX(`${node.id}_select`)\n\t\t\t\t// BX(node.id + '_select'),\n\t\t\t\t// (node.hasAttribute('multiple') ?\n\t\t\t\t// \t\t//BX(node.id + '_target') : BX(node.id + '_select')\n\t\t\t\t// \t\tBX(`${node.id}_select`) : BX(node.id + '_select')\n\t\t\t\t// )\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n};"],"names":["nodeEnum","select","eventNode","container","click","BX","delegate","callback","multiple","titles","values","defaultTitles","init","prototype","hasAttribute","setAttribute","addCustomEvent","initValues","bind","ii","options","length","push","innerHTML","value","e","show","PreventDefault","BXMobileApp","UI","SelectPicker","multiselect","default_value","data","keys","jj","html","removeAttribute","util","in_array","Loc","getMessage","onCustomEvent","window","app","exec","Mobile","Field","Enum","params","__proto__","bindElement","node","result","id"],"mappings":"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"}